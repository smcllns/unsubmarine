var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function u(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let i,c;function s(e,...n){if(null==e)return t;const r=e.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}function a(t){let e;return s(t,t=>e=t)(),e}function l(t,e,n){t.$$.on_destroy.push(s(e,n))}function f(t,e,n,r){return t[1]&&r?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](r(e))):n.ctx}function p(t,e){t.appendChild(e)}function d(t,e,n){t.insertBefore(e,n||null)}function h(t){t.parentNode&&t.parentNode.removeChild(t)}function m(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function b(t){return document.createElement(t)}function v(t){return document.createTextNode(t)}function y(){return v(" ")}function x(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function g(t){return function(e){return e.preventDefault(),t.call(this,e)}}function w(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function $(t,e){e=""+e,t.data!==e&&(t.data=e)}function k(t){c=t}const _=[],S=[];let j=[];const A=[],P=Promise.resolve();let O=!1;function T(t){j.push(t)}const E=new Set;let C=0;function M(){if(0!==C)return;const t=c;do{try{for(;C<_.length;){const t=_[C];C++,k(t),N(t.$$)}}catch(t){throw _.length=0,C=0,t}for(k(null),_.length=0,C=0;S.length;)S.pop()();for(let t=0;t<j.length;t+=1){const e=j[t];E.has(e)||(E.add(e),e())}j.length=0}while(_.length);for(;A.length;)A.pop()();O=!1,E.clear(),k(t)}function N(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(T)}}const q=new Set;let I;function L(){I={r:0,c:[],p:I}}function B(){I.r||r(I.c),I=I.p}function U(t,e){t&&t.i&&(q.delete(t),t.i(e))}function G(t,e,n,r){if(t&&t.o){if(q.has(t))return;q.add(t),I.c.push(()=>{q.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}function R(t){t&&t.c()}function F(t,n,u,i){const{fragment:c,after_update:s}=t.$$;c&&c.m(n,u),i||T(()=>{const n=t.$$.on_mount.map(e).filter(o);t.$$.on_destroy?t.$$.on_destroy.push(...n):r(n),t.$$.on_mount=[]}),s.forEach(T)}function D(t,e){const n=t.$$;null!==n.fragment&&(!function(t){const e=[],n=[];j.forEach(r=>-1===t.indexOf(r)?e.push(r):n.push(r)),n.forEach(t=>t()),j=e}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function z(t,e){-1===t.$$.dirty[0]&&(_.push(t),O||(O=!0,P.then(M)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function V(e,o,u,i,s,a,l,f=[-1]){const p=c;k(e);const d=e.$$={fragment:null,ctx:[],props:a,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(p?p.$$.context:[])),callbacks:n(),dirty:f,skip_bound:!1,root:o.target||p.$$.root};l&&l(d.root);let m=!1;if(d.ctx=u?u(e,o.props||{},(t,n,...r)=>{const o=r.length?r[0]:n;return d.ctx&&s(d.ctx[t],d.ctx[t]=o)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](o),m&&z(e,t)),n}):[],d.update(),m=!0,r(d.before_update),d.fragment=!!i&&i(d.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);d.fragment&&d.fragment.l(t),t.forEach(h)}else d.fragment&&d.fragment.c();o.intro&&U(e.$$.fragment),F(e,o.target,o.anchor,o.customElement),M()}k(p)}class H{$destroy(){D(this,1),this.$destroy=t}$on(e,n){if(!o(n))return t;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const t=r.indexOf(n);-1!==t&&r.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}function Y(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Q(t){return function(t){if(Array.isArray(t))return Y(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Y(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Y(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(t,e,n,r,o,u,i){try{var c=t[u](i),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function K(t){return function(){var e=this,n=arguments;return new Promise(function(r,o){var u=t.apply(e,n);function i(t){J(u,r,o,i,c,"next",t)}function c(t){J(u,r,o,i,c,"throw",t)}i(void 0)})}}var W,X={exports:{}},Z={exports:{}};(W=Z).exports=function(t,e){this.v=t,this.k=e},W.exports.__esModule=!0,W.exports.default=W.exports;var tt={exports:{}},et={exports:{}};!function(t){function e(n,r,o,u){var i=Object.defineProperty;try{i({},"",{})}catch(n){i=0}t.exports=e=function(t,n,r,o){function u(n,r){e(t,n,function(t){return this._invoke(n,r,t)})}n?i?i(t,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):t[n]=r:(u("next",0),u("throw",1),u("return",2))},t.exports.__esModule=!0,t.exports.default=t.exports,e(n,r,o,u)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(et),function(t){var e=et.exports;function n(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var r,o,u="function"==typeof Symbol?Symbol:{},i=u.iterator||"@@iterator",c=u.toStringTag||"@@toStringTag";function s(t,n,u,i){var c=n&&n.prototype instanceof l?n:l,s=Object.create(c.prototype);return e(s,"_invoke",function(t,e,n){var u,i,c,s=0,l=n||[],f=!1,p={p:0,n:0,v:r,a:d,f:d.bind(r,4),d:function(t,e){return u=t,i=0,c=r,p.n=e,a}};function d(t,e){for(i=t,c=e,o=0;!f&&s&&!n&&o<l.length;o++){var n,u=l[o],d=p.p,h=u[2];t>3?(n=h===e)&&(c=u[(i=u[4])?5:(i=3,3)],u[4]=u[5]=r):u[0]<=d&&((n=t<2&&d<u[1])?(i=0,p.v=e,p.n=u[1]):d<h&&(n=t<3||u[0]>e||e>h)&&(u[4]=t,u[5]=e,p.n=h,i=0))}if(n||t>1)return a;throw f=!0,e}return function(n,l,h){if(s>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,h),i=l,c=h;(o=i<2?r:c)||!f;){u||(i?i<3?(i>1&&(p.n=-1),d(i,c)):p.n=c:p.v=c);try{if(s=2,u){if(i||(n="next"),o=u[n]){if(!(o=o.call(u,c)))throw TypeError("iterator result is not an object");if(!o.done)return o;c=o.value,i<2&&(i=0)}else 1===i&&(o=u.return)&&o.call(u),i<2&&(c=TypeError("The iterator does not provide a '"+n+"' method"),i=1);u=r}else if((o=(f=p.n<0)?c:t.call(e,p))!==a)break}catch(t){u=r,i=1,c=t}finally{s=1}}return{value:o,done:f}}}(t,u,i),!0),s}var a={};function l(){}function f(){}function p(){}o=Object.getPrototypeOf;var d=[][i]?o(o([][i]())):(e(o={},i,function(){return this}),o),h=p.prototype=l.prototype=Object.create(d);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,e(t,c,"GeneratorFunction")),t.prototype=Object.create(h),t}return f.prototype=p,e(h,"constructor",p),e(p,"constructor",f),f.displayName="GeneratorFunction",e(p,c,"GeneratorFunction"),e(h),e(h,c,"Generator"),e(h,i,function(){return this}),e(h,"toString",function(){return"[object Generator]"}),(t.exports=n=function(){return{w:s,m:m}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports}(tt);var nt={exports:{}},rt={exports:{}},ot={exports:{}};!function(t){var e=Z.exports,n=et.exports;t.exports=function t(r,o){function u(t,n,i,c){try{var s=r[t](n),a=s.value;return a instanceof e?o.resolve(a.v).then(function(t){u("next",t,i,c)},function(t){u("throw",t,i,c)}):o.resolve(a).then(function(t){s.value=t,i(s)},function(t){return u("throw",t,i,c)})}catch(t){c(t)}}var i;this.next||(n(t.prototype),n(t.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),n(this,"_invoke",function(t,e,n){function r(){return new o(function(e,r){u(t,n,e,r)})}return i=i?i.then(r,r):r()},!0)},t.exports.__esModule=!0,t.exports.default=t.exports}(ot),function(t){var e=tt.exports,n=ot.exports;t.exports=function(t,r,o,u,i){return new n(e().w(t,r,o,u),i||Promise)},t.exports.__esModule=!0,t.exports.default=t.exports}(rt),function(t){var e=rt.exports;t.exports=function(t,n,r,o,u){var i=e(t,n,r,o,u);return i.next().then(function(t){return t.done?t.value:i.next()})},t.exports.__esModule=!0,t.exports.default=t.exports}(nt);var ut={exports:{}};!function(t){t.exports=function(t){var e=Object(t),n=[];for(var r in e)n.unshift(r);return function t(){for(;n.length;)if((r=n.pop())in e)return t.value=r,t.done=!1,t;return t.done=!0,t}},t.exports.__esModule=!0,t.exports.default=t.exports}(ut);var it={exports:{}},ct={exports:{}};!function(t){function e(n){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(ct),function(t){var e=ct.exports.default;t.exports=function(t){if(null!=t){var n=t["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length))return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}}}throw new TypeError(e(t)+" is not iterable")},t.exports.__esModule=!0,t.exports.default=t.exports}(it),function(t){var e=Z.exports,n=tt.exports,r=nt.exports,o=rt.exports,u=ot.exports,i=ut.exports,c=it.exports;function s(){var a=n(),l=a.m(s),f=(Object.getPrototypeOf?Object.getPrototypeOf(l):l.__proto__).constructor;function p(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))}var d={throw:1,return:2,break:3,continue:3};function h(t){var e,n;return function(r){e||(e={stop:function(){return n(r.a,2)},catch:function(){return r.v},abrupt:function(t,e){return n(r.a,d[t],e)},delegateYield:function(t,o,u){return e.resultName=o,n(r.d,c(t),u)},finish:function(t){return n(r.f,t)}},n=function(t,n,o){r.p=e.prev,r.n=e.next;try{return t(n,o)}finally{e.next=r.n}}),e.resultName&&(e[e.resultName]=r.v,e.resultName=void 0),e.sent=r.v,e.next=r.n;try{return t.call(this,e)}finally{r.p=e.prev,r.n=e.next}}}return(t.exports=s=function(){return{wrap:function(t,e,n,r){return a.w(h(t),e,n,r&&r.reverse())},isGeneratorFunction:p,mark:a.m,awrap:function(t,n){return new e(t,n)},AsyncIterator:u,async:function(t,e,n,u,i){return(p(e)?o:r)(h(t),e,n,u,i)},keys:i,values:c}},t.exports.__esModule=!0,t.exports.default=t.exports)()}t.exports=s,t.exports.__esModule=!0,t.exports.default=t.exports}(X);var st=X.exports(),at=st;try{regeneratorRuntime=st}catch(t){"object"==typeof globalThis?globalThis.regeneratorRuntime=st:Function("r","regeneratorRuntime = r")(st)}function lt(t){return lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lt(t)}function ft(t){var e=function(t,e){if("object"!=lt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,e||"default");if("object"!=lt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==lt(e)?e:e+""}function pt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ft(r.key),r)}}function dt(t,e){this.v=t,this.k=e}function ht(t){return new dt(t,0)}function mt(t){var e,n;function r(e,n){try{var u=t[e](n),i=u.value,c=i instanceof dt;Promise.resolve(c?i.v:i).then(function(n){if(c){var s="return"===e?"return":"next";if(!i.k||n.done)return r(s,n);n=t[s](n).value}o(u.done?"return":"normal",n)},function(t){r("throw",t)})}catch(t){o("throw",t)}}function o(t,o){switch(t){case"return":e.resolve({value:o,done:!0});break;case"throw":e.reject(o);break;default:e.resolve({value:o,done:!1})}(e=e.next)?r(e.key,e.arg):n=null}this._invoke=function(t,o){return new Promise(function(u,i){var c={key:t,arg:o,resolve:u,reject:i,next:null};n?n=n.next=c:(e=n=c,r(t,o))})},"function"!=typeof t.return&&(this.return=void 0)}function bt(){return Array.from(document.querySelectorAll("[role=main] [role=row]")).filter(function(t){return t.offsetParent}).length>0}function vt(){return Array.from(document.querySelectorAll("[role=main] [role=listitem]")).filter(function(t){return t.offsetParent}).length>0}function yt(){return{firstItem:Array.from(document.querySelectorAll("[role=main] [role=row]")).filter(function(t){return t.offsetParent})[0]}}function xt(){var t,e,n,r,o,u=(o=document.querySelectorAll('[data-tooltip="Older"]:not([aria-disabled="true"])'),{nextBtn:Array.from(o).filter(function(t){return t.offsetParent})[0]}).nextBtn,i=document.querySelector("[role=main]"),c=Array.from(i.querySelectorAll("a")).filter(function(t){return/unsubscribe/i.test(t.textContent)||/unsubscribe/i.test(t.href)}),s=c.length>0&&c[0],a=i.querySelector("[idlink]"),l="unsubscribe"===(null==a||null===(t=a.textContent)||void 0===t?void 0:t.toLowerCase())&&a,f=null===(e=i.querySelectorAll("span .go")[0])||void 0===e||null===(e=e.textContent)||void 0===e?void 0:e.replace(/[<>]/g,""),p=null===(n=i.querySelectorAll("[data-thread-perm-id]")[0])||void 0===n?void 0:n.textContent,d=null===(r=i.querySelectorAll('[alt*=":"][title*=":"]')[0])||void 0===r?void 0:r.textContent,h=window.location.href;return{sender:f,subject:p,when:d,unsubLink:s.href,unsubBtn:l,nextBtn:u,url:h}}function gt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return wt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?wt(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,i=!0,c=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return i=t.done,t},e:function(t){c=!0,u=t},f:function(){try{i||null==n.return||n.return()}finally{if(c)throw u}}}}function wt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}mt.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},mt.prototype.next=function(t){return this._invoke("next",t)},mt.prototype.throw=function(t){return this._invoke("throw",t)},mt.prototype.return=function(t){return this._invoke("return",t)};var $t=function(){return new Promise(function(t,e){var n=new MutationObserver(function(e){var r,o=gt(e);try{for(o.s();!(r=o.n()).done;){var u=r.value;"attributes"===u.type&&"main"===u.target.getAttribute("role")&&(console.log("gmail page change detected"),n.disconnect(),t(u.target))}}catch(t){o.e(t)}finally{o.f()}});n.observe(document,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["role"]})})},kt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.killSwitch=!1,this.prevRun},e=[{key:"start",value:function(){var t,e=this;return(t=at.mark(function t(){var n;return at.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.prevRun=void 0;case 1:if(!e.killSwitch){t.next=2;break}return t.abrupt("return");case 2:return n=void 0,t.prev=3,t.next=4,ht(e.run());case 4:n=t.sent,t.next=6;break;case 5:return t.prev=5,t.catch(3),console.log("err"),t.abrupt("return");case 6:if(!n.skipIncrement){t.next=7;break}return t.abrupt("continue",1);case 7:if(!n.stopped){t.next=8;break}return t.abrupt("return");case 8:return t.next=9,n;case 9:e.prevRun=n,t.next=1;break;case 10:case"end":return t.stop()}},t,null,[[3,5]])}),function(){return new mt(t.apply(this,arguments))})()}},{key:"run",value:(r=K(at.mark(function t(){var e=this;return at.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("started run()"),t.abrupt("return",new Promise(function(){var t=K(at.mark(function t(n,r){var o,u;return at.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!bt()){t.next=2;break}return yt().firstItem.click(),t.next=1,$t();case 1:return t.abrupt("return",n({skipIncrement:!0}));case 2:if(!vt()){t.next=5;break}if((u=xt()).url!==(null===(o=e.prevRun)||void 0===o?void 0:o.url)){t.next=3;break}return t.abrupt("return",n({stopped:!0}));case 3:if(!u.nextBtn){t.next=4;break}return u.nextBtn.click(),t.next=4,$t();case 4:return t.abrupt("return",n(u));case 5:r();case 6:case"end":return t.stop()}},t)}));return function(e,n){return t.apply(this,arguments)}}()));case 1:case"end":return t.stop()}},t)})),function(){return r.apply(this,arguments)})}],e&&pt(t.prototype,e),n&&pt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();const _t=[];function St(e,n=t){let r;const o=new Set;function i(t){if(u(e,t)&&(e=t,r)){const t=!_t.length;for(const t of o)t[1](),_t.push(t,e);if(t){for(let t=0;t<_t.length;t+=2)_t[t][0](_t[t+1]);_t.length=0}}}return{set:i,update:function(t){i(t(e))},subscribe:function(u,c=t){const s=[u,c];return o.add(s),1===o.size&&(r=n(i)||t),u(e),()=>{o.delete(s),0===o.size&&r&&(r(),r=null)}}}}var jt=function(){var t=St(!1),e=t.subscribe,n=t.set,r=t.update,o=[!1,"start","progress","review"];return{subscribe:e,moveToNextView:function(t){switch(!0){case o.includes(t):n(t);break;case Number.isInteger(t)&&t<o.length:n(o[t]);break;case void 0===lt(t):r(function(t){return o[o.indexOf(t)+1]});break;default:console.log("can't switch to viewState",t)}},reset:function(){return n(!1)}}}(),At=St(0),Pt=St([]),Ot=St(!1),Tt=St(50);function Et(t){var e,n,r,o=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,r=Symbol.iterator);o--;){if(n&&null!=(e=t[n]))return e.call(t);if(r&&null!=(e=t[r]))return new Ct(e.call(t));n="@@asyncIterator",r="@@iterator"}throw new TypeError("Object is not async iterable")}function Ct(t){function e(t){if(Object(t)!==t)return Promise.reject(new TypeError(t+" is not an object."));var e=t.done;return Promise.resolve(t.value).then(function(t){return{value:t,done:e}})}return Ct=function(t){this.s=t,this.n=t.next},Ct.prototype={s:null,n:null,next:function(){return e(this.n.apply(this.s,arguments))},return:function(t){var n=this.s.return;return void 0===n?Promise.resolve({value:t,done:!0}):e(n.apply(this.s,arguments))},throw:function(t){var n=this.s.return;return void 0===n?Promise.reject(t):e(n.apply(this.s,arguments))}},new Ct(t)}function Mt(){!function(){Lt.apply(this,arguments)}(),jt.moveToNextView("progress")}function Nt(){Ot.set(!0),jt.moveToNextView(!1)}function qt(){Ot.set(!0),jt.moveToNextView("review")}function It(t){"Escape"===t.key&&Nt()}function Lt(){return(Lt=K(at.mark(function t(){var e,n,r,o,u,i,c,s,l,f,p;return at.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e=new kt,At.set(0),Pt.set([]),Ot.set(!1),n=a(Tt),r=0,o=Ot.subscribe(function(t){return e.killSwitch=t}),u=!1,i=!1,t.prev=1,s=at.mark(function t(){var o;return at.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(o=f.value,At.update(function(t){return t+1}),o.unsubLink&&Pt.update(function(t){return r=t.length+1,[].concat(Q(t),[o])}),console.log("result from unsub generator",r,n,o),!o.error&&!e.killSwitch){t.next=1;break}return console.log("hitting stop due to error/killswitch"),t.abrupt("return",0);case 1:if(!(r>=n)){t.next=2;break}return console.log("hitting stop due to max limit hit"),t.abrupt("return",0);case 2:case"end":return t.stop()}},t)}),l=Et(e.start());case 2:return t.next=3,l.next();case 3:if(!(u=!(f=t.sent).done)){t.next=6;break}return t.delegateYield(s(),"t0",4);case 4:if(0!==t.t0){t.next=5;break}return t.abrupt("continue",6);case 5:u=!1,t.next=2;break;case 6:t.next=8;break;case 7:t.prev=7,p=t.catch(1),i=!0,c=p;case 8:if(t.prev=8,t.prev=9,!u||null==l.return){t.next=10;break}return t.next=10,l.return();case 10:if(t.prev=10,!i){t.next=11;break}throw c;case 11:return t.finish(10);case 12:return t.finish(8);case 13:o(),qt();case 14:case"end":return t.stop()}},t,null,[[1,7,8,13],[9,,10,12]])}))).apply(this,arguments)}function Bt(t){let e,n,r,o,u,c,s,a,l,m,v,$,k,_,S,j,A;const P=t[2].default,O=function(t,e,n,r){if(t){const o=f(t,e,n,r);return t[0](o)}}(P,t,t[1],null);return{c(){var f,p;e=b("div"),n=b("div"),r=b("div"),o=y(),u=b("div"),u.textContent="âœ–",c=y(),s=b("header"),a=b("img"),m=y(),v=b("h1"),v.textContent="Unsubmarine",$=y(),k=b("p"),k.textContent="Bulk Unsubscribe in Gmail",_=y(),O&&O.c(),w(r,"class","Dialog__Shadow svelte-105czqc"),w(u,"class","Dialog__Close svelte-105czqc"),w(a,"alt","unsubmarine logo"),f=a.src,p=l=t[0],i||(i=document.createElement("a")),i.href=p,f!==i.href&&w(a,"src",l),w(a,"width","64px"),w(a,"height","auto"),w(a,"class","mx-auto pb-2"),w(v,"class","text-3xl font-bold"),w(s,"class","pb-2 mx-auto text-center"),w(n,"class","Dialog flex flex-col justify-center p-4 mx-4 bg-white text-black pointer-events-auto relative rounded-t-md w-full max-w-xl svelte-105czqc"),w(e,"class","Dialog__Container flex flex-1 flex-col-reverse pointer-events-none items-end justify-start svelte-105czqc")},m(t,i){d(t,e,i),p(e,n),p(n,r),p(n,o),p(n,u),p(n,c),p(n,s),p(s,a),p(s,m),p(s,v),p(s,$),p(s,k),p(n,_),O&&O.m(n,null),S=!0,j||(A=x(u,"click",g(Nt)),j=!0)},p(t,[e]){O&&O.p&&(!S||2&e)&&function(t,e,n,r,o,u){if(o){const i=f(e,n,r,u);t.p(i,o)}}(O,P,t,t[1],S?function(t,e,n,r){if(t[2]&&r){const o=t[2](r(n));if(void 0===e.dirty)return o;if("object"==typeof o){const t=[],n=Math.max(e.dirty.length,o.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|o[r];return t}return e.dirty|o}return e.dirty}(P,t[1],e,null):function(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}(t[1]),null)},i(t){S||(U(O,t),S=!0)},o(t){G(O,t),S=!1},d(t){t&&h(e),O&&O.d(t),j=!1,A()}}}function Ut(t,e,n){let{$$slots:r={},$$scope:o}=e,u=chrome.runtime.getURL("images/icon128.png");return t.$$set=t=>{"$$scope"in t&&n(1,o=t.$$scope)},[u,o,r]}class Gt extends H{constructor(t){super(),V(this,t,Ut,Bt,u,{})}}function Rt(e){let n,r,o,u,i,c,s,a;return{c(){n=b("div"),r=b("p"),r.textContent="Unsubmarine automates the process of clicking through emails to find\n      unsubscribe links, and presents them in one list so you can choose what to\n      bulk unsubscribe from.",o=y(),u=b("div"),u.innerHTML='<h3 class="text-lg font-semibold">Start Search</h3>',i=y(),c=b("p"),c.innerHTML='Unsubmarine is an open source client-only browser extension so your data\n      doesn&#39;t leave your browser, and it has no persistent storage so it doesn&#39;t\n      remember anything after a page refresh. It does nothing until you click\n      Start. <a href="https://github.com/smcllns/unsubmarine">Code on github</a>.',w(r,"class","py-4 text-center"),w(u,"class","Btn Primary p-4 mb-4"),w(c,"class","pb-4 text-sm"),w(n,"class","mx-auto")},m(t,l){d(t,n,l),p(n,r),p(n,o),p(n,u),p(n,i),p(n,c),s||(a=x(u,"click",g(e[0])),s=!0)},p:t,d(t){t&&h(n),s=!1,a()}}}function Ft(t){let e,n;return e=new Gt({props:{$$slots:{default:[Rt]},$$scope:{ctx:t}}}),{c(){R(e.$$.fragment)},m(t,r){F(e,t,r),n=!0},p(t,[n]){const r={};8&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){G(e.$$.fragment,t),n=!1},d(t){D(e,t)}}}function Dt(t){return[async t=>{jt.moveToNextView(!1),await async function(){const t=document.querySelector("[name=q]"),e=t.closest("form"),n=e.style.backgroundColor;e.style.backgroundColor="tomato",e.style.color="white",await function(t,e){return new Promise((n,r)=>{e.split("").forEach((r,o)=>{setTimeout(()=>{t.value=e.slice(0,o+1),o===e.length-1&&n()},200*o+100*Math.random())})})}(t,"unsubscribe"),e.style.backgroundColor=n,e.style.color="inherit","#search/unsubscribe"!==window.location.hash&&(window.location.hash="#search/unsubscribe",await $t(),await function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3;return new Promise(function(e,n){var r=Date.now(),o=function(){Array.from(document.querySelectorAll("[role=main] [role=row]")).filter(function(t){return t.offsetParent}).length>0?e():Date.now()-r>t?n(new Error("Timeout waiting for list view")):requestAnimationFrame(o)};o()})}())}(),Mt()}]}class zt extends H{constructor(t){super(),V(this,t,Dt,Ft,u,{})}}function Vt(t,e,n){const r=t.slice();return r[12]=e[n],r[14]=n,r}function Ht(t,e,n){const r=t.slice();return r[15]=e[n],r}function Yt(t){let e;return{c(){e=b("tr"),e.innerHTML='<td colspan="5" class="text-center svelte-rvf7oi">No results to display</td>'},m(t,n){d(t,e,n)},d(t){t&&h(e)}}}function Qt(t){let e,n,r,o=t[6](t[15].when)+"";return{c(){e=v("("),n=v(o),r=v(")")},m(t,o){d(t,e,o),d(t,n,o),d(t,r,o)},p(t,e){1&e&&o!==(o=t[6](t[15].when)+"")&&$(n,o)},d(t){t&&h(e),t&&h(n),t&&h(r)}}}function Jt(t){let e,n,r,o,u,i,c,s,a,l=t[15].subject+"",f=t[6](t[15].when).length>0;function m(...e){return t[9](t[15],...e)}let k=f&&Qt(t);return{c(){e=v("ðŸ“§ "),n=b("a"),r=v(l),u=y(),k&&k.c(),i=y(),c=b("br"),w(n,"href",o=t[15].url)},m(t,o){d(t,e,o),d(t,n,o),p(n,r),d(t,u,o),k&&k.m(t,o),d(t,i,o),d(t,c,o),s||(a=x(n,"click",g(m)),s=!0)},p(e,u){t=e,1&u&&l!==(l=t[15].subject+"")&&$(r,l),1&u&&o!==(o=t[15].url)&&w(n,"href",o),1&u&&(f=t[6](t[15].when).length>0),f?k?k.p(t,u):(k=Qt(t),k.c(),k.m(i.parentNode,i)):k&&(k.d(1),k=null)},d(t){t&&h(e),t&&h(n),t&&h(u),k&&k.d(t),t&&h(i),t&&h(c),s=!1,a()}}}function Kt(t){let e,n,r,o,u,i,c,s,a,l,f,g,k,_,S,j,A,P,O,T,E=t[14]+1+"",C=t[12][0].sender+"";function M(...e){return t[8](t[14],...e)}let N=t[12],q=[];for(let e=0;e<N.length;e+=1)q[e]=Jt(Ht(t,N,e));return{c(){e=b("tr"),n=b("td"),r=b("label"),o=b("input"),i=y(),c=b("td"),s=v(E),a=v("."),l=y(),f=b("td"),g=b("label"),k=v(C),_=y(),S=b("br"),j=y(),A=b("label");for(let t=0;t<q.length;t+=1)q[t].c();P=y(),w(o,"type","checkbox"),o.checked=u=t[12].checked,w(o,"id",`i-${t[14]}`),w(o,"name",`i-${t[14]}`),w(r,"for",`i-${t[14]}`),w(r,"class","px-2"),w(n,"class","text-center svelte-rvf7oi"),w(c,"class","text-gray-400 svelte-rvf7oi"),w(g,"for",`i-${t[14]}`),w(g,"class","font-bold"),w(A,"for",`i-${t[14]}`),w(f,"class","svelte-rvf7oi"),w(e,"class","align-top hover:bg-gray-200")},m(t,u){d(t,e,u),p(e,n),p(n,r),p(r,o),p(e,i),p(e,c),p(c,s),p(c,a),p(e,l),p(e,f),p(f,g),p(g,k),p(f,_),p(f,S),p(f,j),p(f,A);for(let t=0;t<q.length;t+=1)q[t]&&q[t].m(A,null);p(e,P),O||(T=x(o,"change",M),O=!0)},p(e,n){if(t=e,1&n&&u!==(u=t[12].checked)&&(o.checked=u),1&n&&C!==(C=t[12][0].sender+"")&&$(k,C),65&n){let e;for(N=t[12],e=0;e<N.length;e+=1){const r=Ht(t,N,e);q[e]?q[e].p(r,n):(q[e]=Jt(r),q[e].c(),q[e].m(A,null))}for(;e<q.length;e+=1)q[e].d(1);q.length=N.length}},d(t){t&&h(e),m(q,t),O=!1,T()}}}function Wt(e){let n,r,o;return{c(){n=b("button"),n.textContent="Cancel",w(n,"class","Btn Tertiary")},m(t,e){d(t,n,e),r||(o=x(n,"click",g(qt),!0),r=!0)},p:t,d(t){t&&h(n),r=!1,o()}}}function Xt(e){let n,r,o;return{c(){n=b("button"),n.textContent="Quit",w(n,"class","Btn Tertiary")},m(t,e){d(t,n,e),r||(o=x(n,"click",g(Nt),!0),r=!0)},p:t,d(t){t&&h(n),r=!1,o()}}}function Zt(t){let e,n,o,u,i,c,s,a,l,f,k,_,S,j,A,P,O,T,E,C,M,N,q,I,L,B,U,G=(t[0].length||0)+"",R=t[1].length+"",F=0===t[0].length&&Yt(),D=t[0],z=[];for(let e=0;e<D.length;e+=1)z[e]=Kt(Vt(t,D,e));let V="progress"===t[2]&&Wt(),H="review"===t[2]&&Xt();return{c(){e=b("div"),n=b("table"),o=b("thead"),u=b("tr"),i=b("td"),c=b("input"),s=y(),a=b("td"),l=y(),f=b("td"),k=v("Senders with Unsubscribe Links ("),_=v(G),S=v(")"),j=y(),A=b("tbody"),F&&F.c(),P=y();for(let t=0;t<z.length;t+=1)z[t].c();O=y(),T=b("div"),V&&V.c(),E=y(),H&&H.c(),C=y(),M=b("button"),N=v("Click "),q=v(R),I=v(" Unsubscribe Links"),w(c,"type","checkbox"),c.checked=!0,w(i,"class","text-center svelte-rvf7oi"),w(a,"class","svelte-rvf7oi"),w(f,"class","svelte-rvf7oi"),w(o,"class","font-bold border-b border-gray-300"),w(A,"class","svelte-rvf7oi"),w(n,"class","w-full my-4"),w(e,"class","overflow-y-auto"),M.disabled=L=t[1].length<1,w(M,"class","Btn Primary"),w(T,"class","flex justify-between items-center pt-4 border-t border-gray-300")},m(r,h){d(r,e,h),p(e,n),p(n,o),p(o,u),p(u,i),p(i,c),p(u,s),p(u,a),p(u,l),p(u,f),p(f,k),p(f,_),p(f,S),p(n,j),p(n,A),F&&F.m(A,null),p(A,P);for(let t=0;t<z.length;t+=1)z[t]&&z[t].m(A,null);d(r,O,h),d(r,T,h),V&&V.m(T,null),p(T,E),H&&H.m(T,null),p(T,C),p(T,M),p(M,N),p(M,q),p(M,I),B||(U=[x(c,"change",t[5]),x(M,"click",g(t[3]))],B=!0)},p(t,e){if(1&e&&G!==(G=(t[0].length||0)+"")&&$(_,G),0===t[0].length?F||(F=Yt(),F.c(),F.m(A,P)):F&&(F.d(1),F=null),81&e){let n;for(D=t[0],n=0;n<D.length;n+=1){const r=Vt(t,D,n);z[n]?z[n].p(r,e):(z[n]=Kt(r),z[n].c(),z[n].m(A,null))}for(;n<z.length;n+=1)z[n].d(1);z.length=D.length}"progress"===t[2]?V?V.p(t,e):(V=Wt(),V.c(),V.m(T,E)):V&&(V.d(1),V=null),"review"===t[2]?H?H.p(t,e):(H=Xt(),H.c(),H.m(T,C)):H&&(H.d(1),H=null),2&e&&R!==(R=t[1].length+"")&&$(q,R),2&e&&L!==(L=t[1].length<1)&&(M.disabled=L)},d(t){t&&h(e),F&&F.d(),m(z,t),t&&h(O),t&&h(T),V&&V.d(),H&&H.d(),B=!1,r(U)}}}function te(t){let e,n;return e=new Gt({props:{$$slots:{default:[Zt]},$$scope:{ctx:t}}}),{c(){R(e.$$.fragment)},m(t,r){F(e,t,r),n=!0},p(t,[n]){const r={};262151&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){G(e.$$.fragment,t),n=!1},d(t){D(e,t)}}}function ee(t){chrome.runtime.sendMessage({message:"open_new_tabs",urls:t})}function ne(t,e,n){let r,o;l(t,Pt,t=>n(7,r=t)),l(t,jt,t=>n(2,o=t)),chrome.runtime.getURL("images/icon128.png");let u=[],i=[];function c(t){n(0,u=u.map((e,n)=>(n===t&&(e.checked=!e.checked),e)))}return t.$$.update=()=>{128&t.$$.dirty&&n(0,u=function(t){const e=t.reduce((t,e)=>{const{sender:n,subject:r,when:o,unsubLink:u,url:i}=e,c=n&&n.replace(/[@\.]/g,"");return t[c]||(t[c]=[]),t[c]=[...t[c],{sender:n,subject:r,when:o,unsubLink:u,url:i}],t},{});return Object.values(e)}(r).map(t=>(t.checked=!0,t))),1&t.$$.dirty&&n(1,i=u.filter(t=>t.checked)),1&t.$$.dirty&&(u.length,u.length)},[u,i,o,function(){const t=i.map(t=>t[0].unsubLink);i.length>0&&ee(t)},c,function(t){const e=t.target.checked;n(0,u=u.map((t,n)=>(t.checked=e,t)))},(t="")=>/\((.*)\)/.test(t)?t.match(/\((.*)\)/)[1]:"",r,(t,e)=>c(t),(t,e)=>ee([t.url])]}class re extends H{constructor(t){super(),V(this,t,ne,te,u,{})}}class oe extends H{constructor(t){super(),V(this,t,null,null,u,{})}}function ue(t){let e,n;return e=new zt({}),{c(){R(e.$$.fragment)},m(t,r){F(e,t,r),n=!0},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){G(e.$$.fragment,t),n=!1},d(t){D(e,t)}}}function ie(t){let e,n;return e=new re({}),{c(){R(e.$$.fragment)},m(t,r){F(e,t,r),n=!0},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){G(e.$$.fragment,t),n=!1},d(t){D(e,t)}}}function ce(t){let e,n;return e=new re({}),{c(){R(e.$$.fragment)},m(t,r){F(e,t,r),n=!0},i(t){n||(U(e.$$.fragment,t),n=!0)},o(t){G(e.$$.fragment,t),n=!1},d(t){D(e,t)}}}function se(t){let e,n,r,o,u,i,c="start"===t[0]&&ue(),s="progress"===t[0]&&ie(),a="review"===t[0]&&ce();return u=new oe({}),{c(){e=b("div"),c&&c.c(),n=y(),s&&s.c(),r=y(),a&&a.c(),o=y(),R(u.$$.fragment),w(e,"id","unsubmarine"),w(e,"class","svelte-1w969hk")},m(t,l){d(t,e,l),c&&c.m(e,null),p(e,n),s&&s.m(e,null),p(e,r),a&&a.m(e,null),d(t,o,l),F(u,t,l),i=!0},p(t,[o]){"start"===t[0]?c?1&o&&U(c,1):(c=ue(),c.c(),U(c,1),c.m(e,n)):c&&(L(),G(c,1,1,()=>{c=null}),B()),"progress"===t[0]?s?1&o&&U(s,1):(s=ie(),s.c(),U(s,1),s.m(e,r)):s&&(L(),G(s,1,1,()=>{s=null}),B()),"review"===t[0]?a?1&o&&U(a,1):(a=ce(),a.c(),U(a,1),a.m(e,null)):a&&(L(),G(a,1,1,()=>{a=null}),B())},i(t){i||(U(c),U(s),U(a),U(u.$$.fragment,t),i=!0)},o(t){G(c),G(s),G(a),G(u.$$.fragment,t),i=!1},d(t){t&&h(e),c&&c.d(),s&&s.d(),a&&a.d(),t&&h(o),D(u,t)}}}function ae(t,e,n){let r;return l(t,jt,t=>n(0,r=t)),chrome.runtime.onMessage.addListener((t,e,n)=>{"clicked_browser_extension_icon"===t.message&&(document.removeEventListener("keyup",It),document.addEventListener("keyup",It),jt.moveToNextView("start"))}),[r]}return new class extends H{constructor(t){super(),V(this,t,ae,se,u,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
